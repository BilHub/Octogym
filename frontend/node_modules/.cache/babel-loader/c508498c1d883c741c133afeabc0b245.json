{"ast":null,"code":"var _jsxFileName = \"/home/bil/Desktop/web projects/octopus/Octogym/frontend/src/jsx/components/abonnement/AbonnementEdit.jsx\",\n    _s2 = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport axios from 'axios';\nimport { useGetAPI, usePutAPI } from '../useAPI';\nimport { useHistory } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction refreshPage() {\n  window.location.reload(false);\n}\n\nconst AbonnementEdit = props => {\n  _s2();\n\n  var _s = $RefreshSig$();\n\n  let activityEnd = `${process.env.REACT_APP_API_URL}/rest-api/salle-activite/activite/`;\n  const activities = useGetAPI(activityEnd);\n  const abonnementId = props.match.params.id;\n  let presenceURI = `${process.env.REACT_APP_API_URL}/rest-api/abonnement/${abonnementId}/`;\n  let presenceEditURI = `${process.env.REACT_APP_API_URL}/rest-api/abonnement/${abonnementId}/`;\n  const history = useHistory();\n  const [abActivity, setAbActivity] = useState([]);\n  const [abName, setAbName] = useState('');\n  const [abPrice, setabPrice] = useState('');\n  const [abNumDays, setAbNumDays] = useState('');\n  const [abSeancesQuantity, setAbSeancesQuantity] = useState('');\n  const [abActivityName, setAbActivityName] = useState('');\n  const [abNumClients, setAbNumClients] = useState('');\n  const [selectedActivities, setSelectedActivities] = useState([]);\n  const [isSelected, setIsSelected] = useState(true); //FK \n\n  useEffect(() => {\n    axios.get(presenceURI).then(res => {\n      setAbActivity(res.data.activity);\n      setSelectedActivities(res.data.activity); //fzefzefezfezf\n\n      setAbName(res.data.name);\n      setabPrice(res.data.price);\n      setAbNumDays(res.data.number_of_days);\n      setAbSeancesQuantity(res.data.seances_quantity);\n      setAbActivityName(res.data.activity_name);\n      setAbNumClients(res.data.clients_number);\n    });\n  }, []);\n  console.log('the Presence instance is ======>', selectedActivities, abActivity); // const setNewAbonnement = () => {\n  //   if (creneau  === '') {\n  //     const newClient = {\n  //       hour_entree:hour_entree,\n  //       hour_sortie:hour_sortie,\n  //     }\n  //     return newClient\n  //   }else {\n  //     const newClient = {\n  //       hour_entree:hour_entree,\n  //       hour_sortie:hour_sortie,\n  //       creneau : Number(creneau)\n  //     }\n  //     return newClient\n  //   }\n  // }\n  // const getSelected = (activities, selAct )=> {\n  //   for (let i = 0; i < activities.length; i++) {\n  //     if ( activities[i] === selAct.id){\n  //       console.log('activities[i] === selAct.id', activities[i],selAct.id);\n  //       return isSelected ? true : false\n  //     }\n  //   }\n  // }\n  // useEffect(() => {\n  // }, [selectedActivities]);\n  // useEffect(() => {\n  //   const initialIsChecked = activities.reduce((selectedActivities,activity) => {\n  //     selectedActivities[activity] = false;\n  //     return selectedActivities;\n  //   }, {})\n  //   console.log('the initial state ', initialIsChecked);\n  //   setIsSelected(initialIsChecked)\n  //   console.log('the initial state ', initialIsChecked);\n  // }, [])\n\n  const getSelected = activity => {\n    for (let i = 0; i < selectedActivities.length; i++) {\n      if (selectedActivities[i] === activity) {\n        console.log('activities[i] === selAct.id', selectedActivities[i], selectedActivities, activity);\n        return true;\n      }\n    }\n  };\n\n  const handleCheckbox = event => {\n    const activity = event.target.name;\n\n    if (event.target.checked) {\n      setSelectedActivities(checkedActivities => [...checkedActivities, Number(activity)]); // setAbActivity(checkedActivities => [...checkedActivities, Number(activity)])\n\n      console.log('maladiieiieiis=======>', selectedActivities); // setIsSelected(true)\n    } else {\n      // setIsSelected(false)\n      for (var i = 0; i < selectedActivities.length; i++) {\n        if (selectedActivities[i] === Number(activity)) {\n          selectedActivities.splice(i, 1);\n        }\n      }\n\n      selectedActivities.splice(Number(activity), 1);\n      console.log('unchecked=======>', selectedActivities);\n    }\n  };\n\n  const HandleSubmit = async e => {\n    _s();\n\n    console.log('unchecked=======>', selectedActivities);\n    e.preventDefault();\n    const newAbonnement = {\n      name: abName,\n      price: abPrice,\n      number_of_days: abNumDays,\n      activity: selectedActivities,\n      seances_quantity: abSeancesQuantity // activity_name:abActivityName,\n      // clients_number:abNumClients\n\n    }; // const newClient = setNewPresence()\n\n    console.log('_______---------_______=======>', newAbonnement);\n    usePutAPI(presenceEditURI, newAbonnement); // history.push(\"/abonnements\")\n    // refreshPage()\n  };\n\n  _s(HandleSubmit, \"WivCEu9iiLUvIGdN2icZma8eTWk=\", false, function () {\n    return [usePutAPI];\n  });\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header justify-content-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"card-title\",\n            children: [\"Abonnement    \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-success\",\n              children: abName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 141,\n              columnNumber: 61\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 20\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 141,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            className: \"card-title\",\n            children: [\"Nombre d'inscrits    \", /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"text-success\",\n              children: abNumClients\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 142,\n              columnNumber: 68\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 20\n          }, this), \" \"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"basic-form\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: HandleSubmit,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group col-md-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Libell\\xE9 \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"last_name\",\n                  className: \"form-control\",\n                  value: abName,\n                  placeholder: \"Nom du client\",\n                  onChange: e => setAbName(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 150,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group col-md-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Prix\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"first_name\",\n                  className: \"form-control\",\n                  value: abPrice,\n                  placeholder: \"Pr\\xE9nom du client\",\n                  onChange: e => setabPrice(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 154,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 152,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group col-md-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Nombre de jours\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 157,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"first_name\",\n                  className: \"form-control\",\n                  value: abNumDays,\n                  placeholder: \"Pr\\xE9nom du client\",\n                  onChange: e => setAbNumDays(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 158,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 156,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-row\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"form-group col-md-4\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Nombre de S\\xE9ances \"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 163,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  name: \"last_name\",\n                  className: \"form-control\",\n                  value: abSeancesQuantity,\n                  placeholder: \"Nom du client\",\n                  onChange: e => setAbSeancesQuantity(e.target.value)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 164,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-6\",\n                children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                  children: \"Activit\\xE9es\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 168,\n                  columnNumber: 21\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"row\",\n                  children: activities.map(acti => /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"col-6\",\n                    children: /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"custom-control custom-checkbox mb-3\",\n                      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                        checked: getSelected(acti.id),\n                        type: \"checkbox\",\n                        name: acti.id,\n                        className: \"custom-control-input\",\n                        id: acti.id,\n                        onClick: handleCheckbox\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 175,\n                        columnNumber: 35\n                      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                        className: \"custom-control-label\",\n                        htmlFor: acti.id,\n                        children: [\" \", acti.name]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 176,\n                        columnNumber: 35\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 174,\n                      columnNumber: 33\n                    }, this)\n                  }, acti.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 173,\n                    columnNumber: 27\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 171,\n                  columnNumber: 21\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 161,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"btn btn-primary\",\n              children: \"Modifier\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 183,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 11\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 138,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(AbonnementEdit, \"5i4Jzps3AmWycdHqz+vSe2VK+Kk=\", false, function () {\n  return [useGetAPI, useHistory];\n});\n\n_c = AbonnementEdit;\nexport default AbonnementEdit;\n\nvar _c;\n\n$RefreshReg$(_c, \"AbonnementEdit\");","map":{"version":3,"sources":["/home/bil/Desktop/web projects/octopus/Octogym/frontend/src/jsx/components/abonnement/AbonnementEdit.jsx"],"names":["React","useState","useEffect","axios","useGetAPI","usePutAPI","useHistory","refreshPage","window","location","reload","AbonnementEdit","props","activityEnd","process","env","REACT_APP_API_URL","activities","abonnementId","match","params","id","presenceURI","presenceEditURI","history","abActivity","setAbActivity","abName","setAbName","abPrice","setabPrice","abNumDays","setAbNumDays","abSeancesQuantity","setAbSeancesQuantity","abActivityName","setAbActivityName","abNumClients","setAbNumClients","selectedActivities","setSelectedActivities","isSelected","setIsSelected","get","then","res","data","activity","name","price","number_of_days","seances_quantity","activity_name","clients_number","console","log","getSelected","i","length","handleCheckbox","event","target","checked","checkedActivities","Number","splice","HandleSubmit","e","preventDefault","newAbonnement","value","map","acti"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,SAASC,SAAT,EAAoBC,SAApB,QAAqC,WAArC;AACA,SAAUC,UAAV,QAA4B,kBAA5B;;;AAGA,SAASC,WAAT,GAAuB;AACrBC,EAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB,CAAuB,KAAvB;AACD;;AACD,MAAMC,cAAc,GAAIC,KAAD,IAAW;AAAA;;AAAA;;AAChC,MAAIC,WAAW,GAAI,GAAEC,OAAO,CAACC,GAAR,CAAYC,iBAAkB,oCAAnD;AAEA,QAAMC,UAAU,GAAGb,SAAS,CAACS,WAAD,CAA5B;AACA,QAAMK,YAAY,GAAGN,KAAK,CAACO,KAAN,CAAYC,MAAZ,CAAmBC,EAAxC;AAEA,MAAIC,WAAW,GAAI,GAAER,OAAO,CAACC,GAAR,CAAYC,iBAAkB,wBAAuBE,YAAa,GAAvF;AACA,MAAIK,eAAe,GAAI,GAAET,OAAO,CAACC,GAAR,CAAYC,iBAAkB,wBAAuBE,YAAa,GAA3F;AACA,QAAMM,OAAO,GAAGlB,UAAU,EAA1B;AACA,QAAM,CAACmB,UAAD,EAAaC,aAAb,IAA8BzB,QAAQ,CAAC,EAAD,CAA5C;AACA,QAAM,CAAC0B,MAAD,EAASC,SAAT,IAAsB3B,QAAQ,CAAC,EAAD,CAApC;AACA,QAAM,CAAC4B,OAAD,EAAUC,UAAV,IAAwB7B,QAAQ,CAAC,EAAD,CAAtC;AACA,QAAM,CAAC8B,SAAD,EAAYC,YAAZ,IAA4B/B,QAAQ,CAAC,EAAD,CAA1C;AACA,QAAM,CAACgC,iBAAD,EAAoBC,oBAApB,IAA4CjC,QAAQ,CAAC,EAAD,CAA1D;AACA,QAAM,CAACkC,cAAD,EAAiBC,iBAAjB,IAAsCnC,QAAQ,CAAC,EAAD,CAApD;AACA,QAAM,CAACoC,YAAD,EAAeC,eAAf,IAAkCrC,QAAQ,CAAC,EAAD,CAAhD;AACA,QAAM,CAACsC,kBAAD,EAAqBC,qBAArB,IAA8CvC,QAAQ,CAAC,EAAD,CAA5D;AACA,QAAM,CAACwC,UAAD,EAAaC,aAAb,IAA8BzC,QAAQ,CAAC,IAAD,CAA5C,CAjBgC,CAmBhC;;AACAC,EAAAA,SAAS,CAAC,MAAM;AACdC,IAAAA,KAAK,CAACwC,GAAN,CAAUrB,WAAV,EAAuBsB,IAAvB,CAA6BC,GAAD,IAAS;AAEnCnB,MAAAA,aAAa,CAACmB,GAAG,CAACC,IAAJ,CAASC,QAAV,CAAb;AACAP,MAAAA,qBAAqB,CAACK,GAAG,CAACC,IAAJ,CAASC,QAAV,CAArB,CAHmC,CAGK;;AACxCnB,MAAAA,SAAS,CAACiB,GAAG,CAACC,IAAJ,CAASE,IAAV,CAAT;AACAlB,MAAAA,UAAU,CAACe,GAAG,CAACC,IAAJ,CAASG,KAAV,CAAV;AACAjB,MAAAA,YAAY,CAACa,GAAG,CAACC,IAAJ,CAASI,cAAV,CAAZ;AACAhB,MAAAA,oBAAoB,CAACW,GAAG,CAACC,IAAJ,CAASK,gBAAV,CAApB;AACAf,MAAAA,iBAAiB,CAACS,GAAG,CAACC,IAAJ,CAASM,aAAV,CAAjB;AACAd,MAAAA,eAAe,CAACO,GAAG,CAACC,IAAJ,CAASO,cAAV,CAAf;AACD,KAVD;AAWD,GAZQ,EAYN,EAZM,CAAT;AAcAC,EAAAA,OAAO,CAACC,GAAR,CAAY,kCAAZ,EAA+ChB,kBAA/C,EAAmEd,UAAnE,EAlCgC,CAoClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACE;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACE;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,QAAM+B,WAAW,GAAIT,QAAD,IAAc;AAChC,SAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGlB,kBAAkB,CAACmB,MAAvC,EAA+CD,CAAC,EAAhD,EAAoD;AAClD,UAAKlB,kBAAkB,CAACkB,CAAD,CAAlB,KAA0BV,QAA/B,EAAwC;AACtCO,QAAAA,OAAO,CAACC,GAAR,CAAY,6BAAZ,EAA2ChB,kBAAkB,CAACkB,CAAD,CAA7D,EAAiElB,kBAAjE,EAAqFQ,QAArF;AACA,eAAO,IAAP;AACD;AACF;AACF,GAPD;;AAUF,QAAMY,cAAc,GAAIC,KAAD,IAAW;AAChC,UAAMb,QAAQ,GAAGa,KAAK,CAACC,MAAN,CAAab,IAA9B;;AACE,QAAKY,KAAK,CAACC,MAAN,CAAaC,OAAlB,EAA0B;AACxBtB,MAAAA,qBAAqB,CAACuB,iBAAiB,IAAI,CAAC,GAAGA,iBAAJ,EAAuBC,MAAM,CAACjB,QAAD,CAA7B,CAAtB,CAArB,CADwB,CAExB;;AACAO,MAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ,EAAsChB,kBAAtC,EAHwB,CAIxB;AACD,KALD,MAKM;AACJ;AAEA,WAAM,IAAIkB,CAAC,GAAG,CAAd,EAAkBA,CAAC,GAAGlB,kBAAkB,CAACmB,MAAzC,EAAiDD,CAAC,EAAlD,EAAqD;AACnD,YAAIlB,kBAAkB,CAACkB,CAAD,CAAlB,KAA0BO,MAAM,CAACjB,QAAD,CAApC,EAA+C;AAE7CR,UAAAA,kBAAkB,CAAC0B,MAAnB,CAA0BR,CAA1B,EAA6B,CAA7B;AACD;AACF;;AAEDlB,MAAAA,kBAAkB,CAAC0B,MAAnB,CAA0BD,MAAM,CAACjB,QAAD,CAAhC,EAA6C,CAA7C;AACAO,MAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiChB,kBAAjC;AACH;AACF,GApBD;;AAqBE,QAAM2B,YAAY,GAAG,MAAMC,CAAN,IAAW;AAAA;;AAC9Bb,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiChB,kBAAjC;AAEE4B,IAAAA,CAAC,CAACC,cAAF;AACA,UAAMC,aAAa,GAAG;AACpBrB,MAAAA,IAAI,EAACrB,MADe;AAEpBsB,MAAAA,KAAK,EAACpB,OAFc;AAGpBqB,MAAAA,cAAc,EAACnB,SAHK;AAIpBgB,MAAAA,QAAQ,EAACR,kBAJW;AAKpBY,MAAAA,gBAAgB,EAAClB,iBALG,CAMpB;AACA;;AAPoB,KAAtB,CAJ4B,CAa5B;;AACAqB,IAAAA,OAAO,CAACC,GAAR,CAAY,iCAAZ,EAA+Cc,aAA/C;AACAhE,IAAAA,SAAS,CAACkB,eAAD,EAAkB8C,aAAlB,CAAT,CAf4B,CAiB5B;AACA;AACH,GAnBD;;AAzGgC,KAyG1BH,YAzG0B;AAAA,YAwH5B7D,SAxH4B;AAAA;;AA8HhC,sBACM;AAAK,IAAA,SAAS,EAAC,EAAf;AAAA,2BACE;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA,8BACE;AAAK,QAAA,SAAS,EAAC,qCAAf;AAAA,gCACE;AAAA,kCAAK;AAAI,YAAA,SAAS,EAAC,YAAd;AAAA,sDAAyC;AAAM,cAAA,SAAS,EAAC,cAAhB;AAAA,wBAAgCsB;AAAhC;AAAA;AAAA;AAAA;AAAA,oBAAzC;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAL;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,eAEE;AAAA,kCAAK;AAAI,YAAA,SAAS,EAAC,YAAd;AAAA,6DAAgD;AAAM,cAAA,SAAS,EAAC,cAAhB;AAAA,wBAAgCU;AAAhC;AAAA;AAAA;AAAA;AAAA,oBAAhD;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAL;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,cADF,eAKE;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA,+BACE;AAAK,UAAA,SAAS,EAAC,YAAf;AAAA,iCACE;AAAM,YAAA,QAAQ,EAAE6B,YAAhB;AAAA,oCACE;AAAK,cAAA,SAAS,EAAC,UAAf;AAAA,sCACE;AAAK,gBAAA,SAAS,EAAC,qBAAf;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAO,kBAAA,IAAI,EAAC,MAAZ;AAAmB,kBAAA,IAAI,EAAC,WAAxB;AAAoC,kBAAA,SAAS,EAAC,cAA9C;AAA4D,kBAAA,KAAK,EAAEvC,MAAnE;AAA2E,kBAAA,WAAW,EAAC,eAAvF;AAAuG,kBAAA,QAAQ,EAAEwC,CAAC,IAAIvC,SAAS,CAACuC,CAAC,CAACN,MAAF,CAASS,KAAV;AAA/H;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAKE;AAAK,gBAAA,SAAS,EAAC,qBAAf;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAQ,kBAAA,IAAI,EAAC,MAAb;AAAoB,kBAAA,IAAI,EAAC,YAAzB;AAAuC,kBAAA,SAAS,EAAC,cAAjD;AAAgE,kBAAA,KAAK,EAAEzC,OAAvE;AAAgF,kBAAA,WAAW,EAAC,qBAA5F;AAA8G,kBAAA,QAAQ,EAAEsC,CAAC,IAAIrC,UAAU,CAACqC,CAAC,CAACN,MAAF,CAASS,KAAV;AAAvI;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBALF,eASE;AAAK,gBAAA,SAAS,EAAC,qBAAf;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAQ,kBAAA,IAAI,EAAC,MAAb;AAAoB,kBAAA,IAAI,EAAC,YAAzB;AAAuC,kBAAA,SAAS,EAAC,cAAjD;AAAgE,kBAAA,KAAK,EAAEvC,SAAvE;AAAkF,kBAAA,WAAW,EAAC,qBAA9F;AAAgH,kBAAA,QAAQ,EAAEoC,CAAC,IAAInC,YAAY,CAACmC,CAAC,CAACN,MAAF,CAASS,KAAV;AAA3I;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBATF;AAAA;AAAA;AAAA;AAAA;AAAA,oBADF,eAeE;AAAK,cAAA,SAAS,EAAC,UAAf;AAAA,sCACE;AAAK,gBAAA,SAAS,EAAC,qBAAf;AAAA,wCACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADF,eAEE;AAAO,kBAAA,IAAI,EAAC,MAAZ;AAAmB,kBAAA,IAAI,EAAC,WAAxB;AAAoC,kBAAA,SAAS,EAAC,cAA9C;AAA4D,kBAAA,KAAK,EAAErC,iBAAnE;AAAsF,kBAAA,WAAW,EAAC,eAAlG;AAAkH,kBAAA,QAAQ,EAAEkC,CAAC,IAAIjC,oBAAoB,CAACiC,CAAC,CAACN,MAAF,CAASS,KAAV;AAArJ;AAAA;AAAA;AAAA;AAAA,wBAFF;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,eAME;AAAK,gBAAA,SAAS,EAAC,OAAf;AAAA,wCACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBADA,eAIA;AAAK,kBAAA,SAAS,EAAC,KAAf;AAAA,4BACQrD,UAAU,CAACsD,GAAX,CAAeC,IAAI,iBACrB;AAAmB,oBAAA,SAAS,EAAC,OAA7B;AAAA,2CACM;AAAK,sBAAA,SAAS,EAAC,qCAAf;AAAA,8CACE;AAAO,wBAAA,OAAO,EAAEhB,WAAW,CAACgB,IAAI,CAACnD,EAAN,CAA3B;AAAsC,wBAAA,IAAI,EAAC,UAA3C;AAAsD,wBAAA,IAAI,EAAEmD,IAAI,CAACnD,EAAjE;AAAqE,wBAAA,SAAS,EAAC,sBAA/E;AAAsG,wBAAA,EAAE,EAAEmD,IAAI,CAACnD,EAA/G;AAAoH,wBAAA,OAAO,EAAEsC;AAA7H;AAAA;AAAA;AAAA;AAAA,8BADF,eAEE;AAAO,wBAAA,SAAS,EAAC,sBAAjB;AAAwC,wBAAA,OAAO,EAAEa,IAAI,CAACnD,EAAtD;AAAA,wCAA4DmD,IAAI,CAACxB,IAAjE;AAAA;AAAA;AAAA;AAAA;AAAA,8BAFF;AAAA;AAAA;AAAA;AAAA;AAAA;AADN,qBAAUwB,IAAI,CAACnD,EAAf;AAAA;AAAA;AAAA;AAAA,0BADE;AADR;AAAA;AAAA;AAAA;AAAA,wBAJA;AAAA;AAAA;AAAA;AAAA;AAAA,sBANF;AAAA;AAAA;AAAA;AAAA;AAAA,oBAfF,eAqCE;AAAQ,cAAA,IAAI,EAAC,QAAb;AAAsB,cAAA,SAAS,EAAC,iBAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBArCF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,cALF;AAAA;AAAA;AAAA;AAAA;AAAA;AADF;AAAA;AAAA;AAAA;AAAA,UADN;AAwDD,CAtLD;;IAAMV,c;UAGeP,S,EAKHE,U;;;KARZK,c;AAuLN,eAAeA,cAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from 'axios';\r\n\r\nimport { useGetAPI, usePutAPI } from '../useAPI'\r\nimport {  useHistory } from \"react-router-dom\";\r\n\r\n \r\nfunction refreshPage() {\r\n  window.location.reload(false);\r\n}\r\nconst AbonnementEdit = (props) => {\r\n  let activityEnd = `${process.env.REACT_APP_API_URL}/rest-api/salle-activite/activite/`\r\n\r\n  const activities = useGetAPI(activityEnd)\r\n  const abonnementId = props.match.params.id;\r\n\r\n  let presenceURI = `${process.env.REACT_APP_API_URL}/rest-api/abonnement/${abonnementId}/`\r\n  let presenceEditURI = `${process.env.REACT_APP_API_URL}/rest-api/abonnement/${abonnementId}/`\r\n  const history = useHistory();\r\n  const [abActivity, setAbActivity] = useState([]);\r\n  const [abName, setAbName] = useState('')\r\n  const [abPrice, setabPrice] = useState('')\r\n  const [abNumDays, setAbNumDays] = useState('')\r\n  const [abSeancesQuantity, setAbSeancesQuantity] = useState('')\r\n  const [abActivityName, setAbActivityName] = useState('')\r\n  const [abNumClients, setAbNumClients] = useState('')\r\n  const [selectedActivities, setSelectedActivities] = useState([])\r\n  const [isSelected, setIsSelected] = useState(true)\r\n \r\n  //FK \r\n  useEffect(() => {\r\n    axios.get(presenceURI).then((res) => {\r\n    \r\n      setAbActivity(res.data.activity)\r\n      setSelectedActivities(res.data.activity)//fzefzefezfezf\r\n      setAbName(res.data.name)\r\n      setabPrice(res.data.price)\r\n      setAbNumDays(res.data.number_of_days)\r\n      setAbSeancesQuantity(res.data.seances_quantity)\r\n      setAbActivityName(res.data.activity_name)\r\n      setAbNumClients(res.data.clients_number)\r\n    })\r\n  }, []);\r\n  \r\n  console.log('the Presence instance is ======>',selectedActivities, abActivity);\r\n\r\n// const setNewAbonnement = () => {\r\n//   if (creneau  === '') {\r\n//     const newClient = {\r\n//       hour_entree:hour_entree,\r\n//       hour_sortie:hour_sortie,\r\n//     }\r\n//     return newClient\r\n//   }else {\r\n//     const newClient = {\r\n//       hour_entree:hour_entree,\r\n//       hour_sortie:hour_sortie,\r\n//       creneau : Number(creneau)\r\n\r\n//     }\r\n//     return newClient\r\n//   }\r\n// }\r\n  // const getSelected = (activities, selAct )=> {\r\n\r\n  //   for (let i = 0; i < activities.length; i++) {\r\n  //     if ( activities[i] === selAct.id){\r\n  //       console.log('activities[i] === selAct.id', activities[i],selAct.id);\r\n  //       return isSelected ? true : false\r\n  //     }\r\n  //   }\r\n  // }\r\n    // useEffect(() => {\r\n\r\n  // }, [selectedActivities]);\r\n  // useEffect(() => {\r\n  //   const initialIsChecked = activities.reduce((selectedActivities,activity) => {\r\n  //     selectedActivities[activity] = false;\r\n  //     return selectedActivities;\r\n  //   }, {})\r\n  //   console.log('the initial state ', initialIsChecked);\r\n  //   setIsSelected(initialIsChecked)\r\n  //   console.log('the initial state ', initialIsChecked);\r\n  // }, [])\r\n  const getSelected = (activity )=> {\r\n    for (let i = 0; i < selectedActivities.length; i++) {\r\n      if ( selectedActivities[i] === activity){\r\n        console.log('activities[i] === selAct.id', selectedActivities[i],selectedActivities, activity);\r\n        return true \r\n      }\r\n    }\r\n  }\r\n\r\n  \r\nconst handleCheckbox = (event) => {\r\n  const activity = event.target.name\r\n    if ( event.target.checked){\r\n      setSelectedActivities(checkedActivities => [...checkedActivities, Number(activity)])\r\n      // setAbActivity(checkedActivities => [...checkedActivities, Number(activity)])\r\n      console.log('maladiieiieiis=======>', selectedActivities);\r\n      // setIsSelected(true)\r\n    }else {\r\n      // setIsSelected(false)\r\n\r\n      for ( var i = 0 ; i < selectedActivities.length; i++){\r\n        if (selectedActivities[i] === Number(activity)){\r\n\r\n          selectedActivities.splice(i, 1)\r\n        } \r\n      }\r\n\r\n      selectedActivities.splice(Number(activity) , 1)\r\n      console.log('unchecked=======>', selectedActivities);\r\n  }\r\n}\r\n  const HandleSubmit = async e => {\r\n    console.log('unchecked=======>', selectedActivities);\r\n\r\n      e.preventDefault();\r\n      const newAbonnement = {\r\n        name:abName,\r\n        price:abPrice,\r\n        number_of_days:abNumDays,\r\n        activity:selectedActivities,\r\n        seances_quantity:abSeancesQuantity,\r\n        // activity_name:abActivityName,\r\n        // clients_number:abNumClients\r\n      }\r\n      // const newClient = setNewPresence()\r\n      console.log('_______---------_______=======>', newAbonnement);\r\n      usePutAPI(presenceEditURI, newAbonnement)\r\n\r\n      // history.push(\"/abonnements\")\r\n      // refreshPage()\r\n  }\r\n\r\n  return (\r\n        <div className=\"\">\r\n          <div className=\"card\">\r\n            <div className=\"card-header justify-content-between\">\r\n              <div><h4 className=\"card-title\">Abonnement    <span className=\"text-success\">{abName}</span> </h4> </div>\r\n              <div><h4 className=\"card-title\">Nombre d'inscrits    <span className=\"text-success\">{abNumClients}</span> </h4> </div>\r\n            </div>\r\n            <div className=\"card-body\">\r\n              <div className=\"basic-form\">\r\n                <form onSubmit={HandleSubmit}>\r\n                  <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-4\">\r\n                      <label>Libellé </label>\r\n                      <input type=\"text\" name=\"last_name\" className=\"form-control\"value={abName} placeholder=\"Nom du client\" onChange={e => setAbName(e.target.value)}/>\r\n                    </div>\r\n                    <div className=\"form-group col-md-4\">\r\n                      <label>Prix</label>\r\n                      <input  type=\"text\" name=\"first_name\"  className=\"form-control\" value={abPrice} placeholder=\"Prénom du client\"onChange={e => setabPrice(e.target.value)}/>\r\n                    </div>\r\n                    <div className=\"form-group col-md-4\">\r\n                      <label>Nombre de jours</label>\r\n                      <input  type=\"text\" name=\"first_name\"  className=\"form-control\" value={abNumDays} placeholder=\"Prénom du client\"onChange={e => setAbNumDays(e.target.value)}/>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"form-row\">\r\n                    <div className=\"form-group col-md-4\">\r\n                      <label>Nombre de Séances </label>\r\n                      <input type=\"text\" name=\"last_name\" className=\"form-control\"value={abSeancesQuantity} placeholder=\"Nom du client\" onChange={e => setAbSeancesQuantity(e.target.value)}/>\r\n                    </div>\r\n                  \r\n                    <div className=\"col-6\">\r\n                    <label>\r\n                      Activitées\r\n                    </label>\r\n                    <div className=\"row\">\r\n                          { activities.map(acti =>\r\n                          <div key={acti.id} className=\"col-6\">\r\n                                <div className=\"custom-control custom-checkbox mb-3\">\r\n                                  <input checked={getSelected(acti.id)} type=\"checkbox\" name={acti.id} className=\"custom-control-input\" id={acti.id}  onClick={handleCheckbox}/>\r\n                                  <label className=\"custom-control-label\" htmlFor={acti.id}> {acti.name}</label>\r\n                                </div>\r\n                          </div>\r\n                          )}\r\n                    </div>\r\n                  </div>\r\n                  </div>\r\n                  <button type=\"submit\" className=\"btn btn-primary\">\r\n                    Modifier\r\n                  </button>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      \r\n  )\r\n}\r\nexport default AbonnementEdit;\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}